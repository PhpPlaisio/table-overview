function SET_OverviewTable(a){var c=this;var b;if(SET_OverviewTable.ourDebug){SET_OverviewTable.log("Start create OverviewTable:");SET_OverviewTable.myTimeStart=new Date();SET_OverviewTable.myTimeIntermidiate=new Date()}this.$myFilters=a.children("thead").children("tr.filter").find("td");this.$myHeaders=a.children("thead").children("tr.header").find("th");this.myHeaderIndexLookup=[];this.$myTable=a;a.children("thead").children("tr.filter").each(function(){$(this).css("display","table-row")});SET_OverviewTable.benchmark("Prepare table and table info");this.$myHeaders.each(function(d,g){var e;var f;f=$(g).attr("colspan");if(f){f=parseFloat(f)}else{f=1}for(e=0;e<f;e=e+1){c.myHeaderIndexLookup[c.myHeaderIndexLookup.length]=d}});SET_OverviewTable.benchmark("Create lookup table from column_index to header_index");this.myColumnHandlers=[];a.children("colgroup").children("col").each(function(g,e){var d;var f;var h;c.myColumnHandlers[g]=null;d=$(e).attr("class");if(d){f=d.split(" ");for(b=0;b<f.length;b=b+1){if(f[b].substr(0,10)==="data-type-"){h=f[b].substr(10);if(h===undefined||!SET_OverviewTable.ourColumnTypeHandlers[h]){h="none"}break}}}else{h="none"}c.myColumnHandlers[g]=new SET_OverviewTable.ourColumnTypeHandlers[h]();SET_OverviewTable.benchmark('Install column handler with type "'+h+'"');c.myColumnHandlers[g].initHandler(c,g);SET_OverviewTable.benchmark("Initialize column handler");c.myColumnHandlers[g].initFilter(c,g);SET_OverviewTable.benchmark("Initialize filter");c.myColumnHandlers[g].initSort(c,g);SET_OverviewTable.benchmark("Initialize sorter")});this.initHook();SET_OverviewTable.benchmark("Execute additional initializations");if(SET_OverviewTable.ourDebug){SET_OverviewTable.log("End of create OverviewTable "+(new Date().getTime()-SET_OverviewTable.myTimeIntermidiate.getTime())+"ms")}}SET_OverviewTable.prototype.initHook=function(){};SET_OverviewTable.prototype.filterHook=function(){};SET_OverviewTable.ourDebug=false;SET_OverviewTable.ourTables={};SET_OverviewTable.ourColumnTypeHandlers={};SET_OverviewTable.ourCharacterMap={"à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ě":"e","ę":"e","ð":"d","ì":"i","í":"i","î":"i","ï":"i","ł":"l","ñ":"n","ń":"n","ň":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ş":"s","š":"s","ý":"y","ÿ":"y","ž":"z","þ":"th","ß":"ss","À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ě":"E","Ę":"E","Ð":"D","Ì":"I","Í":"I","Î":"I","Ï":"I","Ł":"L","Ñ":"N","Ń":"N","Ň":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ş":"S","Š":"S","Ý":"Y","Ÿ":"Y","Ž":"Z","Þ":"TH"};SET_OverviewTable.toLowerCaseNoAccents=function(d){var e;var a="";var b;if(d===null||d===undefined){return d}for(b=0;b<d.length;b=b+1){e=d.substr(b,1);if(SET_OverviewTable.ourCharacterMap[e]){a+=SET_OverviewTable.ourCharacterMap[e]}else{a+=e}}return a.toLowerCase()};SET_OverviewTable.enableDebug=function(){SET_OverviewTable.ourDebug=true};SET_OverviewTable.prototype.mergeInfo=function(b,a){if(b.length===0){a.sort_order=1;b[0]=a}else{if(a.sort_order!==-1&&b[a.sort_order-1]){b[a.sort_order-1].sort_direction=a.sort_direction}else{a.sort_order=b.length+1;b[b.length]=a}}return b};SET_OverviewTable.prototype.getSortOrder=function(c,d){var b;var f;var g;var e;var a=-1;b=c.attr("class");if(b){f=b.split(" ");for(e=0;e<f.length;e=e+1){g="sort-order"+d;if(f[e].substr(0,g.length)===g){a=parseInt(f[e].substr(g.length),10)}}}return a};SET_OverviewTable.prototype.getSortDirection=function(a,b){if(a.hasClass("sorted"+b+"desc")){return"desc"}if(a.hasClass("sorted"+b+"asc")){return"asc"}return""};SET_OverviewTable.prototype.sort=function(e,b,d,f){var c;var a;if(SET_OverviewTable.ourDebug){SET_OverviewTable.log("Start sort:");SET_OverviewTable.myTimeStart=new Date();SET_OverviewTable.myTimeIntermidiate=new Date()}c=this.getSortInfo();SET_OverviewTable.benchmark("Get all sort info");a=this.getColumnSortInfo(e,b,f);SET_OverviewTable.benchmark("Get info about current column");this.cleanSortClasses();SET_OverviewTable.benchmark("Reset column headers");if(!e.ctrlKey){c=this.mergeInfo([],a);SET_OverviewTable.benchmark("Merge info");this.sortSingleColumn(c[0],d)}else{c=this.mergeInfo(c,a);SET_OverviewTable.benchmark("Merge info");if(c.length===1){this.sortSingleColumn(c[0],d)}else{this.sortMultiColumn(c)}}this.addSortInfo(c);SET_OverviewTable.benchmark("Added info to table head");this.applyZebraTheme();SET_OverviewTable.benchmark("Apply zebra theme");if(SET_OverviewTable.ourDebug){SET_OverviewTable.log("Finish sort "+(new Date().getTime()-SET_OverviewTable.myTimeIntermidiate.getTime())+"ms")}};SET_OverviewTable.prototype.getSortInfo=function(){var b=[];var c;var a;var e;var d=this;var g;var f;this.$myTable.children("colgroup").children("col").each(function(i){var h=d.$myHeaders.eq(d.myHeaderIndexLookup[i]);c=h.attr("colspan");if(!c||c==="1"){a=d.getSortOrder(h,"-");if(a!==-1){b[a-1]={column_index:i,sort_order:a,sort_direction:d.getSortDirection(h,"-"),infix:"-",colspan:1,offset:0}}}else{if(c==="2"){if(!f||f==="right"){f="left"}else{f="right"}if(f==="left"&&h.hasClass("sort-1")){a=d.getSortOrder(h,"-1-");if(a!==-1){b[a-1]={column_index:i,sort_order:a,sort_direction:d.getSortDirection(h,"-1-"),infix:"-1-",colspan:2,offset:0}}}if(f==="right"&&h.hasClass("sort-2")){a=d.getSortOrder(h,"-2-");if(a!==-1){b[a-1]={column_index:i,sort_order:d.getSortDirection(h,"-2-"),sort_direction:e,infix:"-2-",colspan:2,offset:1}}}}}});return b};SET_OverviewTable.prototype.getColumnSortInfo=function(b,a,d){var k;var c={};var h;var g;var f;var j;var i;function e(n,l,m){var o;o=n.getSortDirection(l,m);if(o==="desc"||o===""){return"asc"}return"desc"}c.column_index=d;k=a.attr("colspan");if(!k||k==="1"){c.infix="-";c.colspan=1;c.offset=0;c.sort_order=this.getSortOrder(a,c.infix);c.sort_direction=e(this,a,c.infix)}else{if(k==="2"){if(a.hasClass("sort-1")&&a.hasClass("sort-2")){i=b.pageX-a.offset().left;if(this.myHeaderIndexLookup[d]===this.myHeaderIndexLookup[d-1]){h=this.$myTable.children("tbody").find("tr:visible:first > td:eq("+(d-1)+")").outerWidth();g=this.$myTable.children("tbody").find("tr:visible:first > td:eq("+d+")").outerWidth()}if(this.myHeaderIndexLookup[d]===this.myHeaderIndexLookup[d+1]){h=this.$myTable.children("tbody").find("tr:visible:first > td:eq("+d+")").outerWidth();g=this.$myTable.children("tbody").find("tr:visible:first > td:eq("+(d+1)+")").outerWidth()}f=a.outerWidth();j=f-h-g;if(i<(h-j/2)){c.infix="-1-";c.colspan=2;c.offset=0;c.sort_order=this.getSortOrder(a,c.infix);c.sort_direction=e(this,a,c.infix)}else{if(i>(h+j/2)){c.infix="-2-";c.colspan=2;c.offset=1;c.sort_order=this.getSortOrder(a,c.infix);c.sort_direction=e(this,a,c.infix)}}}else{if(a.hasClass("sort-1")){c.infix="-1-";c.colspan=2;c.offset=0;c.sort_order=this.getSortOrder(a,c.infix);c.sort_direction=e(this,a,c.infix)}else{if(a.hasClass("sort-2")){c.infix="-2-";c.colspan=2;c.offset=1;c.sort_order=this.getSortOrder(a,c.infix);c.sort_direction=e(this,a,c.infix)}}}}}return c};SET_OverviewTable.prototype.cleanSortClasses=function(){var b=this;var a;for(a=0;a<b.myColumnHandlers.length;a=a+1){b.$myTable.children("thead").find("th").removeClass("sort-order-"+a);b.$myTable.children("thead").find("th").removeClass("sort-order-1-"+a);b.$myTable.children("thead").find("th").removeClass("sort-order-2-"+a)}b.$myTable.children("thead").find("th").removeClass("sorted-asc").removeClass("sorted-desc");b.$myTable.children("thead").find("th").removeClass("sorted-1-asc").removeClass("sorted-1-desc");b.$myTable.children("thead").find("th").removeClass("sorted-2-asc").removeClass("sorted-2-desc")};SET_OverviewTable.prototype.addSortInfo=function(d){var a;var b;var c;for(c=0;c<d.length;c=c+1){a=c+1;b=this.$myHeaders.eq(this.myHeaderIndexLookup[d[c].column_index]);b.addClass("sort-order"+d[c].infix+a);b.addClass("sorted"+d[c].infix+d[c].sort_direction)}};SET_OverviewTable.prototype.applyZebraTheme=function(){var a=true;this.$myTable.children("tbody").children("tr").each(function(){var b=$(this);if(this.style.display!=="none"){if(a===true){b.removeClass("odd").addClass("even")}else{b.removeClass("even").addClass("odd")}a=!a}})};SET_OverviewTable.prototype.sortSingleColumn=function(b,e){var g;var f;var d;var c;if(!b.infix){return}if(b.sort_direction==="asc"){f=1}else{f=-1}g=this.$myTable.children("tbody").children("tr").get();for(d=0;d<g.length;d=d+1){var a=g[d].cells[b.column_index];g[d].sortKey=e.getSortKey(a)}SET_OverviewTable.benchmark("Extracting sort keys");g.sort(function(i,h){return f*e.compareSortKeys(i.sortKey,h.sortKey)});SET_OverviewTable.benchmark("Sorted by one column");c=this.$myTable.children("tbody")[0];for(d=0;d<g.length;d=d+1){g[d].sortKey=null;c.appendChild(g[d])}SET_OverviewTable.benchmark("Reappend the sorted rows")};SET_OverviewTable.prototype.sortMultiColumn=function(sorting_info){var dir;var cmp;var i,j;var sort_func="";var rows;var cell;var column_handler;var tbody;var that=this;var multi_cmp=null;rows=this.$myTable.children("tbody").children("tr").get();for(i=0;i<rows.length;i=i+1){rows[i].sortKey=[];for(j=0;j<sorting_info.length;j=j+1){column_handler=this.myColumnHandlers[sorting_info[j].column_index];cell=rows[i].cells[sorting_info[j].column_index];rows[i].sortKey[j]=column_handler.getSortKey(cell)}}SET_OverviewTable.benchmark("Extracting sort keys");sort_func+="multi_cmp = function (row1, row2) {\n";sort_func+="  var cmp;\n";for(i=0;i<sorting_info.length;i=i+1){dir=1;if(sorting_info[i].sort_direction==="desc"){dir=-1}sort_func+="  cmp = that.myColumnHandlers["+sorting_info[i].column_index+"].compareSortKeys(row1.sortKey["+i+"], row2.sortKey["+i+"]);\n";sort_func+="  if (cmp !== 0) {\n";sort_func+="    return cmp * "+dir+";\n";sort_func+="  }\n"}sort_func+="  return 0;\n";sort_func+="};\n";eval(sort_func);SET_OverviewTable.benchmark("Prepare multi sort function");rows.sort(multi_cmp);SET_OverviewTable.benchmark("Sorted by "+sorting_info.length+" columns");tbody=this.$myTable.children("tbody")[0];for(i=0;i<rows.length;i=i+1){rows[i].sortKey=null;tbody.appendChild(rows[i])}SET_OverviewTable.benchmark("Reappend the sorted rows")};SET_OverviewTable.prototype.filter=function(){var d=[];var a;var c=this;var b;if(SET_OverviewTable.ourDebug){SET_OverviewTable.log("Apply filters:");SET_OverviewTable.myTimeStart=new Date();SET_OverviewTable.myTimeIntermidiate=new Date()}b=0;for(a=0;a<this.myColumnHandlers.length;a=a+1){if(this.myColumnHandlers[a]&&this.myColumnHandlers[a].startFilter()){d[a]=this.myColumnHandlers[a];b+=1}else{d[a]=null}}SET_OverviewTable.benchmark("Create a list of effective filters");if(b===0){if(SET_OverviewTable.ourDebug){SET_OverviewTable.log("Filters list is empty.")}this.$myTable.children("tbody").children("tr").show();SET_OverviewTable.benchmark("Show all rows")}else{this.$myTable.children("tbody").children("tr").hide();SET_OverviewTable.benchmark("Hide all rows");this.$myTable.children("tbody").children("tr").each(function(){var f;var e=1;var g=$(this);for(f=0;f<d.length;f+=1){if(d[f]&&!d[f].simpleFilter(this.cells[f])){e=0;break}}if(e===1){g.show()}});SET_OverviewTable.benchmark("Apply all effective filters")}c.applyZebraTheme();SET_OverviewTable.benchmark("Apply zebra theme");c.filterHook();SET_OverviewTable.benchmark("Execute additional action after filtering");if(SET_OverviewTable.ourDebug){SET_OverviewTable.log("Finish, total time: "+(new Date().getTime()-SET_OverviewTable.myTimeIntermidiate.getTime())+" ms")}};SET_OverviewTable.registerColumnTypeHandler=function(b,a){SET_OverviewTable.ourColumnTypeHandlers[b]=a};SET_OverviewTable.filterTrigger=function(a){a.data.table.filter(a,a.data.element)};SET_OverviewTable.benchmark=function(a){if(SET_OverviewTable.ourDebug===true){SET_OverviewTable.log(a+" "+(new Date().getTime()-SET_OverviewTable.myTimeStart.getTime())+" ms");SET_OverviewTable.myTimeStart=new Date()}};SET_OverviewTable.log=function(a){if(console!=="undefined"&&console.debug!=="undefined"){console.log(a)}else{alert(a)}};SET_OverviewTable.registerTable=function(a,b){if(b===undefined){b="SET_OverviewTable"}$(a).each(function(){var c=$(this);if(c.is("table")){if(!c.hasClass("registered")){SET_OverviewTable.ourTables[SET_OverviewTable.ourTables.length]=new window[b](c);c.addClass("registered")}}else{c.find("table").first().each(function(){var d=$(this);if(!d.hasClass("registered")){SET_OverviewTable.ourTables[SET_OverviewTable.ourTables.length]=new window[b](d);d.addClass("registered")}})}})};function SET_ColumnTypeHandler(){}SET_ColumnTypeHandler.prototype.startFilter=function(){return false};SET_ColumnTypeHandler.prototype.initHandler=function(){};SET_ColumnTypeHandler.prototype.initSort=function(b,c){var f=this;var a;var h;var d;var g;var e;var i;a=b.$myHeaders.eq(b.myHeaderIndexLookup[c]);if(a.hasClass("sort")){a.click(function(j){b.sort(j,a,f,c)})}else{if(a.hasClass("sort-1")||a.hasClass("sort-2")){a.click(function(j){if(a.hasClass("sort-1")&&a.hasClass("sort-2")){h=j.pageX-a.offset().left;if(b.myHeaderIndexLookup[c]===b.myHeaderIndexLookup[c-1]){g=b.$myTable.children("tbody").children("tr:visible:first").find("td:eq("+(c-1)+")").outerWidth();e=b.$myTable.children("tbody").children("tr:visible:first").find("td:eq("+c+")").outerWidth()}if(b.myHeaderIndexLookup[c]===b.myHeaderIndexLookup[c+1]){g=b.$myTable.children("tbody").children("tr:visible:first").find("td:eq("+c+")").outerWidth();e=b.$myTable.children("tbody").children("tr:visible:first").find("td:eq("+(c+1)+")").outerWidth()}d=a.outerWidth();i=d-g-e;if(h>(g-i/2)){if(b.myHeaderIndexLookup[c]===b.myHeaderIndexLookup[c-1]){b.sort(j,a,f,c)}}else{if(h<(g+i/2)){if(b.myHeaderIndexLookup[c]===b.myHeaderIndexLookup[c+1]){b.sort(j,a,f,c)}}}}else{if(a.hasClass("sort-1")){b.sort(j,a,f,c)}else{if(a.hasClass("sort-2")){b.sort(j,a,f,c)}}}})}}};function SET_NoneColumnTypeHandler(){SET_ColumnTypeHandler.call(this)}SET_NoneColumnTypeHandler.prototype=Object.create(SET_ColumnTypeHandler.prototype);SET_NoneColumnTypeHandler.constructor=SET_NoneColumnTypeHandler;SET_NoneColumnTypeHandler.prototype.initSort=function(){};SET_NoneColumnTypeHandler.prototype.initFilter=function(){};SET_OverviewTable.registerColumnTypeHandler("none",SET_NoneColumnTypeHandler);function SET_TextColumnTypeHandler(){SET_ColumnTypeHandler.call(this);this.$myInput=null;this.myFilterValue=null}SET_TextColumnTypeHandler.prototype=Object.create(SET_ColumnTypeHandler.prototype);SET_TextColumnTypeHandler.constructor=SET_TextColumnTypeHandler;SET_TextColumnTypeHandler.prototype.startFilter=function(){this.myFilterValue=SET_OverviewTable.toLowerCaseNoAccents(this.$myInput.val());return(this.myFilterValue!==undefined&&this.myFilterValue!=="")};SET_TextColumnTypeHandler.prototype.simpleFilter=function(b){var a;a=this.extractForFilter(b);return(a.indexOf(this.myFilterValue)!==-1)};SET_TextColumnTypeHandler.prototype.initFilter=function(a,c){var b=this;this.$myInput=a.$myFilters.eq(c).find("input");this.$myInput.val("");this.$myInput.keyup(function(d){if(d.keyCode===27){b.$myInput.val("")}});this.$myInput.keyup({table:a,element:this.$myInput},SET_OverviewTable.filterTrigger);this.$myInput.width(this.$myInput.width()+(this.$myInput.closest("td").innerWidth()-this.$myInput.outerWidth(true)))};SET_TextColumnTypeHandler.prototype.extractForFilter=function(a){return SET_OverviewTable.toLowerCaseNoAccents($(a).text())};SET_TextColumnTypeHandler.prototype.getSortKey=function(a){return SET_OverviewTable.toLowerCaseNoAccents($(a).text())};SET_TextColumnTypeHandler.prototype.compareSortKeys=function(b,a){if(b<a){return -1}if(b>a){return 1}return 0};SET_OverviewTable.registerColumnTypeHandler("text",SET_TextColumnTypeHandler);SET_OverviewTable.registerColumnTypeHandler("email",SET_TextColumnTypeHandler);function SET_DateTimeColumnTypeHandler(){SET_TextColumnTypeHandler.call(this)}SET_DateTimeColumnTypeHandler.prototype=Object.create(SET_TextColumnTypeHandler.prototype);SET_DateTimeColumnTypeHandler.constructor=SET_DateTimeColumnTypeHandler;SET_DateTimeColumnTypeHandler.prototype.getSortKey=function(e){var c;var d;var a="";var b;c=$(e).attr("class");if(c){d=c.split(/\s+/);for(b=0;b<d.length;b=b+1){if(d[b].substr(0,5)==="data-"){a=decodeURIComponent(d[b].substr(5).replace(/\+/g,"%20"));break}}}return a};SET_OverviewTable.registerColumnTypeHandler("date",SET_DateTimeColumnTypeHandler);SET_OverviewTable.registerColumnTypeHandler("datetime",SET_DateTimeColumnTypeHandler);function SET_NumericColumnTypeHandler(){SET_TextColumnTypeHandler.call(this)}SET_NumericColumnTypeHandler.prototype=Object.create(SET_TextColumnTypeHandler.prototype);SET_NumericColumnTypeHandler.constructor=SET_NumericColumnTypeHandler;SET_NumericColumnTypeHandler.prototype.getSortKey=function(c){var a;var b;a=/[\d\.,\-\+]*/;b=a.exec($(c).text());return parseInt(b[0].replace(".","").replace(",","."),10)};SET_NumericColumnTypeHandler.prototype.compareSortKeys=function(b,a){if(b===a){return 0}if(b===""&&!isNaN(a)){return -1}if(a===""&&!isNaN(b)){return 1}return b-a};SET_OverviewTable.registerColumnTypeHandler("numeric",SET_NumericColumnTypeHandler);SET_OverviewTable.registerColumnTypeHandler("uuid",SET_TextColumnTypeHandler);SET_OverviewTable.registerColumnTypeHandler("ipv4",SET_TextColumnTypeHandler);